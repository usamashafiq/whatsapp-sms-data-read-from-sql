--SELECT        SV.VarietyName, SUM(CPR.WeightPayable) AS Qty
--FROM            CMS_Token TKN
--		INNER JOIN      CMS_TokenVariety CTV ON TKN.TokenNO = CTV.Fk_TokenNo 		 
--		INNER JOIN		Set_Variety SV ON CTV.Fk_Variety = SV.VarietyID 
--		INNER JOIN      CMS_CPRHeader CPR ON TKN.TokenNO = CPR.Fk_TokenNo
--WHERE        (CAST(CPR.CPRDate AS date) <= CAST('2020-11-24 00:00:00' AS date))
--GROUP BY SV.VarietyName 
go 
SELECT        SV.VarietyName,  (SUM(cast(CPR.WeightPayable As decimal)/1000)) AS Qty
FROM            CMS_Token TKN
		INNER JOIN      CMS_TokenVariety CTV ON TKN.TokenNO = CTV.Fk_TokenNo 		 
		INNER JOIN		Set_Variety SV ON CTV.Fk_Variety = SV.VarietyID 
		INNER JOIN      CMS_CPRHeader CPR ON TKN.TokenNO = CPR.Fk_TokenNo
WHERE        (CAST(CPR.CPRDate AS date) =DATEADD(day, -1, CAST(GETDATE() AS date)) )
GROUP BY SV.VarietyName ;